-- Tạo cơ sở dữ liệu
CREATE DATABASE IF NOT EXISTS LAYLOIHOI_DB;
USE LAYLOIHOI_DB;

-- Tạo bảng KHACH_HANG
CREATE TABLE KHACH_HANG(
    MAKH INT PRIMARY KEY,
    TENKH VARCHAR(30),
    DIACHI VARCHAR(50),
    SDT CHAR(11)
);

-- Tạo bảng PHONG
CREATE TABLE PHONG(
    MAPHONG INT PRIMARY KEY,
    LOAIPHONG VARCHAR(20),
    SOKHACHTOIDA INT,
    GIAPHONG DECIMAL(10, 3),
    MOTA VARCHAR(255)
);

-- Tạo bảng DAT_PHONG
CREATE TABLE DAT_PHONG(
    MADATPHONG INT PRIMARY KEY,
    MAPHONG INT,
    MAKH INT,
    NGAYDAT DATE,
    GIOBATDAU TIME,
    GIOKETTHUC TIME,
    TIENDATCOC DECIMAL(10, 3),
    GHICHU VARCHAR(255),
    TRANGTHAIDAT VARCHAR(30),
    FOREIGN KEY (MAPHONG) REFERENCES PHONG(MAPHONG),
    FOREIGN KEY (MAKH) REFERENCES KHACH_HANG(MAKH)
);

-- Tạo bảng DICH_VU_DI_KEM
CREATE TABLE DICH_VU_DI_KEM(
    MADV INT PRIMARY KEY,
    TENDV VARCHAR(255),
    DONVITINH VARCHAR(30),
    DONGIA DECIMAL(10, 3)
);

-- Tạo bảng CHI_TIET_SU_DUNG_DV
CREATE TABLE CHI_TIET_SU_DUNG_DV(
    MADATPHONG INT,
    MADV INT,
    SOLUONG INT,
    PRIMARY KEY (MADATPHONG, MADV),
    FOREIGN KEY (MADATPHONG) REFERENCES DAT_PHONG(MADATPHONG),
    FOREIGN KEY (MADV) REFERENCES DICH_VU_DI_KEM(MADV)
);

-- Chèn dữ liệu
INSERT INTO KHACH_HANG (MAKH, TENKH, DIACHI, SDT) VALUES
(1, 'MARIA OZAWA', 'HOA XUAN', '11111111111'),
(2, 'TOKUDA', 'HOA XUAN', '11111111112'),
(3, 'MIKAMI YUA', 'HOA XUAN', '11111111113'),
(4, 'NGUYEN VAN D', 'HOA XUAN', '11111111114');

INSERT INTO PHONG (MAPHONG, LOAIPHONG, SOKHACHTOIDA, GIAPHONG, MOTA) VALUES
(1, 'LOAI 1', 20, 60000, ''),
(2, 'LOAI 1', 25, 80000, ''),
(3, 'LOAI 2', 15, 50000, ''),
(4, 'LOAI 3', 20, 50000, '');

INSERT INTO DICH_VU_DI_KEM (MADV, TENDV, DONVITINH, DONGIA) VALUES
(1, 'HOT GIRL', 'EM', 10000),
(2, 'HOA HAU', 'EM', 20000),
(3, 'BEER', 'LON', 10000),
(4, 'TRAI CAY', 'DIA', 35000);

INSERT INTO DAT_PHONG (MADATPHONG, MAPHONG, MAKH, NGAYDAT, GIOBATDAU, GIOKETTHUC, TIENDATCOC, GHICHU, TRANGTHAIDAT) VALUES
(1, 1, 2, '2018-03-26', '11:00:00', '13:00:00', 100000, '', 'DA DAT'),
(2, 1, 3, '2018-03-27', '17:15:00', '19:15:00', 50000, '', 'DA HUY'),
(3, 2, 2, '2018-03-26', '20:30:00', '22:15:00', 100000, '', 'DA DAT'),
(4, 3, 1, '2018-04-01', '19:30:00', '21:15:00', 200000, '', 'DA DAT');

INSERT INTO CHI_TIET_SU_DUNG_DV (MADATPHONG, MADV, SOLUONG) VALUES
(1, 1, 20),
(1, 2, 10),
(1, 3, 3),
(2, 2, 10),
(2, 3, 1),
(3, 3, 2),
(3, 4, 10);

-- Tao them testcase

INSERT INTO KHACH_HANG (MAKH, TENKH, DIACHI, SDT) VALUES
(5, 'JONM WICK', 'HOA XUAN', '5651616'),
(6, 'WICKY JOH', 'HOA XUAN', '11111111112'),
(7, 'HOA HAI', 'HOA XUAN', '51561561'),
(8, 'NMA MAN', 'HOA XUAN', '684894984');

INSERT INTO KHACH_HANG (MAKH, TENKH, DIACHI, SDT) VALUES
(9, 'NMasichukwu TOKUDA MARIA OZAWA', 'HOA XUAN', '5651616'),
(10, 'Hmasichukwu TOKUDA MARIA OZAWA', 'HOA XUAN', '11111111112');

INSERT INTO KHACH_HANG (MAKH, TENKH, DIACHI, SDT) VALUES
(11, 'NMA MAN', 'HOA XUAN', '99999999999'),
(12, 'TOKUDA', 'HOA XUAN', '55555555555'),
(13, 'MIKAMI NEGAI', 'HOA XUAN', '777777777'),
(14, 'MEGA MAN X9', 'HOA XUAN', '3333333333');

INSERT INTO DICH_VU_DI_KEM (MADV, TENDV, DONVITINH, DONGIA) VALUES
(5, 'BEER DAC BIET', 'LON', 15000),
(6, 'TEN LUA', 'CAI', 3000),
(7, 'TEN LUA PROMAX', 'LON', 7000);
